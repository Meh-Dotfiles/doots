#!/bin/bash

#black=`tput setaf 0`
red=`tput setaf 1`
green=`tput setaf 2`
yellow=`tput setaf 3`
blue=`tput setaf 4`
#magenta=`tput setaf 5`
cyan=`tput setaf 6`
red=`tput setaf 1`
norm=`tput sgr0`

bold=`tput bold`
#ulbegin=`tput smul`
#ulend=`tput rmul`

ser="$cyan"
name="$bold$cyan"
echo '
        
                  | _)       
     _| _` |   _` |  |   _ \ 
   _| \__,_| \__,_| _| \___/ 
                           ' | ccze -A
                          
            
stations=(
BBCRadio1="http://bbcmedia.ic.llnwd.net/stream/bbcmedia_radio1_mf_p"
BBCRadio2="http://bbcmedia.ic.llnwd.net/stream/bbcmedia_radio2_mf_p"
BBCRadio3="http://bbcmedia.ic.llnwd.net/stream/bbcmedia_radio3_mf_p"
BBCRadio4="http://bbcmedia.ic.llnwd.net/stream/bbcmedia_radio4fm_mf_p"
BBCRadio4.Xtra="http://www.radiofeeds.co.uk/bbcradio4extra.pls"
BBCRadio5.Live="http://www.radiofeeds.co.uk/bbc5live.pls"
BBCWorld.Service="rtmp://wsliveflash.bbc.co.uk:1935/live/eneuk_live@6512"
MyMPD="http://192.168.1.33:9001"
Talksport="http://www.radiofeeds.co.uk/talksport.m3u"
Dubstep="http://67.212.233.124:8014"
Hardcore="http://67.212.233.124:8002"
Clyde1="http://icy-e-bl-04-cr.sharp-stream.com:8000/clyde1.mp3.m3u"
Clyde2="http://icy-e-bl-04-cr.sharp-stream.com:8000/clyde2.mp3.m3u"
Capital="http://media-ice.musicradio.com/CapitalEdinburghMP3.m3u"
PinkFloyd="http://99.198.112.59:8000"
LBC="http://media-ice.musicradio.com/LBCLondonMP3Low.m3u"
Smooth="http://uk1.internet-radio.com:4086"
Zenradio="http://zenradio.fr:8800"
RadioParadise="http://stream-sd.radioparadise.com:9000/rp_128.mp3"
)

#show_inf () {
#  sed -n '/Name/,/Bitrate/ p' $tfile
#  }

while(true); do
  index=0
  echo
  for i in "${stations[@]}"; do
    echo ${ser}$index.${norm} ${name}${i%%=*}${norm}
    index=$[index+1]
  done

  echo
  read -p "${blue}Station:${norm} " sta
  echo

  capture="-capture -dumpfile ${stations[$sta]%%=*}_`date "+%T_%F"`.mp3"

  #tfile=`mktemp`
  mplayer -vc null -vo null -nolirc -msglevel all=4 ${capture} -msgcolor `echo ${stations[$sta]} | cut -d '=' -f2`
 
  echo -ne "${cyan}\nPress Entr to change station ${norm}"
  read -t 5
  [[ $? -gt 128 ]] && { echo && exit 0; }
  #rm $tfile
  unset -v index sta capture
done

exit 0